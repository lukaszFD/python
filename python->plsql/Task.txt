Recruitment Task: PL/SQL Development - CSV Parsing Logic Migration

Task Goal: To assess the candidate's skills in designing a data flow within an Oracle 19c environment and implementing data processing logic, including regular expressions (regex), using PL/SQL.

Scenario: You have received a CSV file containing user account data for a platform. Previously, this data was processed and partially parsed using a simple Python script. As part of a migration to an internal Oracle-based ETL process, your task is to rewrite the parsing logic and implement a complete, multi-stage data flow within the database.

Requirements:

    Data Flow Analysis and Design: Propose a complete and optimal data flow for this scenario in an Oracle 19c environment. It must include a minimum of three database objects in the following sequence:

        Staging Table (Raw Data): For temporary loading of raw data from the CSV file. All columns should be character type (VARCHAR2).

        Materialized View (Data Standardization): To load data from the staging table, applying data type conversions to their target formats (e.g., dates to DATE, numbers to NUMBER).

        View (Final Business View): This will be the final data source, containing all the parsing logic, especially for the Description field.

    PL/SQL Implementation (Python Equivalent):

        Description Field: This field requires parsing using regular expressions. The PL/SQL implementation must faithfully replicate the logic used in the provided Python script for this field.

        IsActive Field: In the Python script, this field is converted to a boolean value (e.g., True/False). In the Oracle database, an appropriate conversion must be applied (e.g., to NUMBER(1) or VARCHAR2).

    Data Loading:

        Outline the method for loading the provided account_data.csv file into your designed Staging Table (e.g., using SQL*Loader, External Table, or another mechanism you specify in your description).

        Write the PL/SQL or DML code to insert data from the Staging Table into the Materialized View and refresh it.

Provided Files and Logic:

    account_data.csv: Example data file.

    csv_parser.py: A simple Python script demonstrating the parsing logic to be replicated.

    Expected Deliverables: A set of .sql files containing:

        DDL code to create all proposed objects.

        PL/SQL/SQL code implementing the logical operations.

        A brief description (in comments or a separate text file) explaining the choice of objects and the data flow strategy.